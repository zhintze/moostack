# Immersive Engineering Chapter Rewrite — Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Replace the existing 126-quest ATM-10 ported IE chapter with a 47-quest hub-and-spoke original chapter covering core IE + guns, juice, and gambling branches.

**Architecture:** Hub-and-spoke with linear core (Foundations→Power→Machines) plus three goal-oriented branches (Armory, Juicery, Casino) and two utility sections (Logistics, Advanced). Hard gates at Steel Ingot, LV Accumulator, Metal Press, and Squeezer.

**Tech Stack:** FTB Quests SNBT format, NeoForge 1.21.1, structured hex IDs with chapter prefix `1E`.

**Design Document:** `docs/plans/2026-02-06-immersive-engineering-chapter-design.md`

---

## Important Context

### Directory Workflow
- **DEVELOP in:** `runs/client/config/ftbquests/quests/`
- **COPY to:** `defaultconfigs/ftbquests/quests/` + `config/ftbquests/quests/` when complete
- **Never edit** defaultconfigs/ or config/ directly

### ID System
- Prefix: `1E` (hex-valid, claimed for Immersive Engineering)
- Format: `1E[SS]000000000[NNN]` where SS=section(01-08), NNN=quest number
- All IDs exactly 16 uppercase hex characters
- IDs WILL be regenerated by FTB Quests on first load — post-load recovery is mandatory

### Item Format (1.21.1)
```snbt
item: { count: 1, id: "modid:item_name" }    # CORRECT
icon: { id: "modid:item_name" }               # CORRECT
```

### Class Registry Gate
All chapters use `default_quest_dependencies: ["0ECEB17B7C8ADD33"]` to gate behind the class selection quest.

### Existing Files to Replace
- `runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt` (64KB, 126 quests)
- Lang entries in `runs/client/config/ftbquests/quests/lang/en_us.snbt` (shared file — only modify IE entries)

### Verified Item Registry IDs
| Item | Registry ID |
|------|------------|
| Pistol | `pointblank:glock17` |
| Rifle | `pointblank:m4a1` |
| Shotgun | `pointblank:m870` |
| Heavy weapon | `pointblank:m249` |
| Pistol ammo | `pointblank:ammo9mm` |
| Scope | `pointblank:acog` |
| Apple juice bucket | `immersiveengineering:apple_juice_bucket` |
| Bottled apple juice | `immersiveengineering:bottled_apple_juice` |
| Bottled apple juice II | `immersiveengineering:bottled_apple_juice_2` |
| Slot machine | `immersive_gambling:slot_machine` |
| Blackjack table | `immersive_gambling:blackjack_table` |
| Blank mold | `immersive_gambling:blank_mold` |
| Copper coin die | `immersive_gambling:copper_coin_die` |
| Annealed copper blank | `immersive_gambling:annealed_copper_blank` |
| Copper coin | `immersive_gambling:copper_coin` |

### FTB Quests Skill Scripts
- Validate: `python ~/.claude/skills/ftb-quests/scripts/validate_chapter.py <file>`
- Extract IDs: `python ~/.claude/skills/ftb-quests/scripts/extract_ids.py <file> [--generate-lang]`
- Verify lang: `python ~/.claude/skills/ftb-quests/scripts/verify_lang.py <chapter> <lang>`

---

## Task 1: Claim ID Prefix and Backup Existing Chapter

**Files:**
- Modify: `docs/ftbquests_setup_guide.md` (add `1E` to prefix registry)
- Backup: `runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt`

**Step 1: Add prefix to registry**

In `docs/ftbquests_setup_guide.md`, find the prefix registry table and add:

```
| `1E01`-`1E08` | Immersive Engineering | Quest IDs (sections 1-8) |
```

**Step 2: Backup existing chapter**

```bash
cp runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt \
   runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt.backup
```

**Step 3: Extract existing IE quest IDs from lang file**

Save the existing IE-related lang entries so we know what to clean up later:

```bash
python ~/.claude/skills/ftb-quests/scripts/extract_ids.py \
  runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt \
  > /tmp/claude-1000/-home-keroppi-Development-Minecraft-mooStack/b9a4759a-45a4-4fb5-9b2c-d46336d33f47/scratchpad/ie_old_ids.txt
```

---

## Task 2: Write Chapter SNBT — Section 1 (Foundations)

**Files:**
- Create: `runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt`

Write the complete chapter file. Start with the chapter header and Section 1 quests.

**Step 1: Write chapter header + Section 1 (9 quests)**

The file must start with the chapter metadata preserving the existing chapter ID `22C20C1827FE6805`, then contain all 47 quests in the `quests: []` array.

**Chapter header:**
```snbt
{
	default_hide_dependency_lines: false
	default_quest_dependencies: ["0ECEB17B7C8ADD33"]
	default_quest_shape: ""
	filename: "immersive_engineering"
	group: ""
	icon: {
		id: "immersiveengineering:hammer"
	}
	id: "22C20C1827FE6805"
	order_index: 4
	quest_links: [ ]
	quests: [
```

**Section 1 quests (9 quests, IDs 1E01000000000001–1E01000000000009):**

Layout positions — use a grid with the Hammer at origin, Coke Oven below, then branching:
```
           Hammer (0,0)
              |
         Coke Oven (0,2)
          /          \
    Alloy Kiln(-2,4)  Blast Furnace(2,4)
    /    |    \              |
 Const  Elec  Brass    Steel Ingot
(-4,6) (-2,6) (0,6)      (2,6)
                      Coal Coke (0,4) [branch from Coke Oven]
```

Actually, let me lay it out more linearly for readability:

```
Hammer (0,0)
   |
Coke Oven (0,1.5)
   |----------\
Coal Coke     Alloy Kiln     Blast Furnace
(-1.5,3)      (0,3)          (1.5,3)
              /  |  \             |
         Const  Elec  Brass  Steel Ingot [GATE]
         (-1.5,4.5) (0,4.5) (1.5,4.5)  (1.5,4.5)
```

Revised layout to avoid overlap — all Y values increase downward:

| Quest | x | y |
|-------|---|---|
| Engineer's Hammer | 0.0 | 0.0 |
| Coke Oven | 0.0 | 1.5 |
| Coal Coke | -1.5 | 3.0 |
| Alloy Kiln | 0.0 | 3.0 |
| Constantan | -1.5 | 4.5 |
| Electrum | 0.0 | 4.5 |
| Brass | 1.5 | 4.5 |
| Blast Furnace | 3.0 | 3.0 |
| Steel Ingot | 3.0 | 4.5 |

Each quest in SNBT format:
```snbt
		{
			icon: { id: "immersiveengineering:hammer" }
			id: "1E01000000000001"
			shape: "gear"
			size: 2.0d
			tasks: [{
				id: "1E01000000000A01"
				item: { count: 1, id: "immersiveengineering:hammer" }
				type: "item"
			}]
			rewards: [{
				id: "1E01000000000B01"
				type: "xp"
				xp: 50
			}]
			x: 0.0d
			y: 0.0d
		}
```

Task IDs use pattern: `1E[SS]000000000A[NN]` (A for tasks)
Reward IDs use pattern: `1E[SS]000000000B[NN]` (B for rewards)

**Full Section 1 SNBT (write all 9 quests with correct dependencies, positions, items):**

Quest 1 - Engineer's Hammer:
- ID: `1E01000000000001`, Task: `1E01000000000A01`, Reward: `1E01000000000B01`
- Item: `immersiveengineering:hammer`
- shape: "gear", size: 2.0d (intro quest is prominent)
- x: 0.0, y: 0.0

Quest 2 - Coke Oven:
- ID: `1E01000000000002`, Task: `1E01000000000A02`, Reward: `1E01000000000B02`
- Item: `immersiveengineering:coke_oven`
- dependencies: ["1E01000000000001"]
- x: 0.0, y: 1.5

Quest 3 - Coal Coke:
- ID: `1E01000000000003`, Task: `1E01000000000A03`, Reward: `1E01000000000B03`
- Item: `immersiveengineering:coal_coke`
- dependencies: ["1E01000000000002"]
- x: -1.5, y: 3.0

Quest 4 - Alloy Kiln:
- ID: `1E01000000000004`, Task: `1E01000000000A04`, Reward: `1E01000000000B04`
- Item: `immersiveengineering:alloy_kiln`
- dependencies: ["1E01000000000002"]
- x: 0.0, y: 3.0

Quest 5 - Constantan Ingot:
- ID: `1E01000000000005`, Task: `1E01000000000A05`, Reward: `1E01000000000B05`
- Item tag: `#c:ingots/constantan` — NOTE: FTB Quests item format for tags needs verification. If tags don't work, use `immersiveengineering:ingot_constantan` or `mekanism:ingot_constantan`
- dependencies: ["1E01000000000004"]
- x: -1.5, y: 4.5

Quest 6 - Electrum Ingot:
- ID: `1E01000000000006`, Task: `1E01000000000A06`, Reward: `1E01000000000B06`
- Item tag: `#c:ingots/electrum` (same caveat as above)
- dependencies: ["1E01000000000004"]
- x: 0.0, y: 4.5

Quest 7 - Brass Ingot:
- ID: `1E01000000000007`, Task: `1E01000000000A07`, Reward: `1E01000000000B07`
- Item: `create:brass_ingot`
- dependencies: ["1E01000000000004"]
- x: 1.5, y: 4.5

Quest 8 - Blast Furnace:
- ID: `1E01000000000008`, Task: `1E01000000000A08`, Reward: `1E01000000000B08`
- Item: `immersiveengineering:blast_furnace`
- dependencies: ["1E01000000000002"]
- x: 3.0, y: 3.0

Quest 9 - Steel Ingot (HARD GATE):
- ID: `1E01000000000009`, Task: `1E01000000000A09`, Reward: `1E01000000000B09`
- Item: `mekanism:ingot_steel`
- dependencies: ["1E01000000000008"]
- shape: "hexagon", size: 1.5d (gate quest is visually distinct)
- x: 3.0, y: 4.5

**Step 2: Validate the partial file structure is correct SNBT**

After writing Section 1, validate with:
```bash
python ~/.claude/skills/ftb-quests/scripts/validate_chapter.py \
  runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt
```

---

## Task 3: Write Chapter SNBT — Section 2 (Power & Wiring)

**Files:**
- Modify: `runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt`

**Add 5 quests (IDs 1E02000000000001–1E02000000000005) to the quests array.**

Layout — continues below Steel Ingot:

| Quest | x | y |
|-------|---|---|
| Treated Wood | 3.0 | 6.5 |
| Engineer's Workbench | 3.0 | 8.0 |
| Wire Connectors | 3.0 | 9.5 |
| Thermoelectric Generator | 1.5 | 11.0 |
| LV Accumulator [GATE] | 3.0 | 11.0 |

Quest 1 - Treated Wood:
- ID: `1E02000000000001`, Task: `1E02000000000A01`, Reward: `1E02000000000B01`
- Item: `immersiveengineering:treated_wood_horizontal`
- dependencies: ["1E01000000000009"] (Steel Ingot gate)
- x: 3.0, y: 6.5

Quest 2 - Engineer's Workbench:
- ID: `1E02000000000002`, Task: `1E02000000000A02`, Reward: `1E02000000000B02`
- Item: `immersiveengineering:workbench`
- dependencies: ["1E02000000000001"]
- x: 3.0, y: 8.0

Quest 3 - Wire Connectors:
- ID: `1E02000000000003`, Task: `1E02000000000A03`, Reward: `1E02000000000B03`
- Item: `immersiveengineering:connector_lv`
- dependencies: ["1E02000000000002"]
- x: 3.0, y: 9.5

Quest 4 - Thermoelectric Generator:
- ID: `1E02000000000004`, Task: `1E02000000000A04`, Reward: `1E02000000000B04`
- Item: `immersiveengineering:thermoelectric_generator`
- dependencies: ["1E02000000000003"]
- x: 1.5, y: 11.0

Quest 5 - LV Accumulator (HARD GATE):
- ID: `1E02000000000005`, Task: `1E02000000000A05`, Reward: `1E02000000000B05`
- Item: `immersiveengineering:capacitor_lv`
- dependencies: ["1E02000000000003"]
- shape: "hexagon", size: 1.5d
- x: 3.0, y: 11.0

---

## Task 4: Write Chapter SNBT — Section 3 (Core Machines)

**Files:**
- Modify: `runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt`

**Add 8 quests (IDs 1E03000000000001–1E03000000000008).**

Layout — branches out from LV Accumulator:

| Quest | x | y |
|-------|---|---|
| Crusher | 3.0 | 12.5 |
| Metal Press [GATE] | 3.0 | 14.0 |
| Squeezer | 0.0 | 15.5 |
| Fermenter | 0.0 | 17.0 |
| Refinery | 0.0 | 18.5 |
| Diesel Generator | 0.0 | 20.0 |
| Arc Furnace | 4.5 | 15.5 |
| Excavator | 6.0 | 15.5 |

Quest 1 - Crusher:
- ID: `1E03000000000001`, Task: `1E03000000000A01`, Reward: `1E03000000000B01`
- Item: `immersiveengineering:crusher`
- dependencies: ["1E02000000000005"] (LV Accumulator gate)
- x: 3.0, y: 12.5

Quest 2 - Metal Press (HARD GATE):
- ID: `1E03000000000002`, Task: `1E03000000000A02`, Reward: `1E03000000000B02`
- Item: `immersiveengineering:metal_press`
- dependencies: ["1E03000000000001"]
- shape: "hexagon", size: 1.5d
- x: 3.0, y: 14.0

Quest 3 - Squeezer:
- ID: `1E03000000000003`, Task: `1E03000000000A03`, Reward: `1E03000000000B03`
- Item: `immersiveengineering:squeezer`
- dependencies: ["1E03000000000002"]
- x: 0.0, y: 15.5

Quest 4 - Fermenter:
- ID: `1E03000000000004`, Task: `1E03000000000A04`, Reward: `1E03000000000B04`
- Item: `immersiveengineering:fermenter`
- dependencies: ["1E03000000000003"]
- x: 0.0, y: 17.0

Quest 5 - Refinery:
- ID: `1E03000000000005`, Task: `1E03000000000A05`, Reward: `1E03000000000B05`
- Item: `immersiveengineering:refinery`
- dependencies: ["1E03000000000004"]
- x: 0.0, y: 18.5

Quest 6 - Diesel Generator:
- ID: `1E03000000000006`, Task: `1E03000000000A06`, Reward: `1E03000000000B06`
- Item: `immersiveengineering:diesel_generator`
- dependencies: ["1E03000000000005"]
- x: 0.0, y: 20.0

Quest 7 - Arc Furnace:
- ID: `1E03000000000007`, Task: `1E03000000000A07`, Reward: `1E03000000000B07`
- Item: `immersiveengineering:arc_furnace`
- dependencies: ["1E03000000000002"]
- x: 4.5, y: 15.5

Quest 8 - Excavator:
- ID: `1E03000000000008`, Task: `1E03000000000A08`, Reward: `1E03000000000B08`
- Item: `immersiveengineering:excavator`
- dependencies: ["1E03000000000002"]
- x: 6.0, y: 15.5

---

## Task 5: Write Chapter SNBT — Section 4 (Logistics)

**Files:**
- Modify: `runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt`

**Add 5 quests (IDs 1E04000000000001–1E04000000000005).**

Layout — branch right from Metal Press:

| Quest | x | y |
|-------|---|---|
| Conveyor Belts | 7.5 | 14.0 |
| Fluid Pipes | 7.5 | 15.5 |
| Silo | 6.0 | 17.0 |
| Tank | 7.5 | 17.0 |
| Item Router | 9.0 | 17.0 |

Quest 1 - Conveyor Belts:
- ID: `1E04000000000001`, Task: `1E04000000000A01`, Reward: `1E04000000000B01`
- Item: `immersiveengineering:conveyor_basic`
- dependencies: ["1E03000000000002"] (Metal Press)
- x: 7.5, y: 14.0

Quest 2 - Fluid Pipes:
- ID: `1E04000000000002`, Task: `1E04000000000A02`, Reward: `1E04000000000B02`
- Item: `immersiveengineering:fluid_pipe`
- dependencies: ["1E04000000000001"]
- x: 7.5, y: 15.5

Quest 3 - Silo:
- ID: `1E04000000000003`, Task: `1E04000000000A03`, Reward: `1E04000000000B03`
- Item: `immersiveengineering:silo`
- dependencies: ["1E04000000000001"]
- x: 6.0, y: 17.0

Quest 4 - Tank:
- ID: `1E04000000000004`, Task: `1E04000000000A04`, Reward: `1E04000000000B04`
- Item: `immersiveengineering:tank`
- dependencies: ["1E04000000000001"]
- x: 7.5, y: 17.0

Quest 5 - Item Router:
- ID: `1E04000000000005`, Task: `1E04000000000A05`, Reward: `1E04000000000B05`
- Item: `immersiveengineering:item_batcher`
- dependencies: ["1E04000000000001"]
- x: 9.0, y: 17.0

---

## Task 6: Write Chapter SNBT — Branch A (Armory)

**Files:**
- Modify: `runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt`

**Add 8 quests (IDs 1E05000000000001–1E05000000000008).**

Layout — branch left-down from Metal Press:

| Quest | x | y |
|-------|---|---|
| Blueprint: Firearms | -3.0 | 14.0 |
| Craft a Pistol | -3.0 | 15.5 |
| Pistol Ammunition | -3.0 | 17.0 |
| Craft a Rifle | -3.0 | 18.5 |
| Craft a Shotgun | -3.0 | 20.0 |
| Heavy Ordnance | -3.0 | 21.5 |
| Blueprint: Scopes | -4.5 | 15.5 |
| Blueprint: Attachments | -1.5 | 15.5 |

Quest 1 - Blueprint: Firearms:
- ID: `1E05000000000001`, Task: `1E05000000000A01`, Reward: `1E05000000000B01`
- Icon: `immersiveengineering:blueprint`
- Task type: item, item: `immersiveengineering:blueprint` — NOTE: blueprint items may need NBT to distinguish categories. If plain blueprint doesn't work, use a representative gun as the task item instead and keep blueprint as icon.
- dependencies: ["1E03000000000002"] (Metal Press)
- shape: "gear", size: 1.5d
- x: -3.0, y: 14.0

Quest 2 - Craft a Pistol:
- ID: `1E05000000000002`, Task: `1E05000000000A02`, Reward: `1E05000000000B02`
- Item: `pointblank:glock17`
- dependencies: ["1E05000000000001"]
- x: -3.0, y: 15.5

Quest 3 - Pistol Ammunition:
- ID: `1E05000000000003`, Task: `1E05000000000A03`, Reward: `1E05000000000B03`
- Item: `pointblank:ammo9mm`
- dependencies: ["1E05000000000002"]
- x: -3.0, y: 17.0

Quest 4 - Craft a Rifle:
- ID: `1E05000000000004`, Task: `1E05000000000A04`, Reward: `1E05000000000B04`
- Item: `pointblank:m4a1`
- dependencies: ["1E05000000000003"]
- x: -3.0, y: 18.5

Quest 5 - Craft a Shotgun:
- ID: `1E05000000000005`, Task: `1E05000000000A05`, Reward: `1E05000000000B05`
- Item: `pointblank:m870`
- dependencies: ["1E05000000000004"]
- x: -3.0, y: 20.0

Quest 6 - Heavy Ordnance:
- ID: `1E05000000000006`, Task: `1E05000000000A06`, Reward: `1E05000000000B06`
- Item: `pointblank:m249`
- dependencies: ["1E05000000000005"]
- x: -3.0, y: 21.5

Quest 7 - Blueprint: Scopes:
- ID: `1E05000000000007`, Task: `1E05000000000A07`, Reward: `1E05000000000B07`
- Item: `pointblank:acog`
- dependencies: ["1E05000000000001"]
- x: -4.5, y: 15.5

Quest 8 - Blueprint: Attachments:
- ID: `1E05000000000008`, Task: `1E05000000000A08`, Reward: `1E05000000000B08`
- Icon: `immersiveengineering:blueprint`
- Item: `pointblank:ar_suppressor` (representative attachment — verify ID exists)
- dependencies: ["1E05000000000001"]
- x: -1.5, y: 15.5

---

## Task 7: Write Chapter SNBT — Branch B (Juicery)

**Files:**
- Modify: `runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt`

**Add 4 quests (IDs 1E06000000000001–1E06000000000004).**

Layout — branch left from Squeezer:

| Quest | x | y |
|-------|---|---|
| Squeeze a Fruit | -1.5 | 17.0 |
| Bottled Juice | -1.5 | 18.5 |
| Potency Levels | -1.5 | 20.0 |
| Juice Pouring | -3.0 | 18.5 |

Quest 1 - Squeeze a Fruit:
- ID: `1E06000000000001`, Task: `1E06000000000A01`, Reward: `1E06000000000B01`
- Item: `immersiveengineering:apple_juice_bucket`
- dependencies: ["1E03000000000003"] (Squeezer)
- x: -1.5, y: 17.0

Quest 2 - Bottled Juice:
- ID: `1E06000000000002`, Task: `1E06000000000A02`, Reward: `1E06000000000B02`
- Item: `immersiveengineering:bottled_apple_juice`
- dependencies: ["1E06000000000001"]
- x: -1.5, y: 18.5

Quest 3 - Potency Levels:
- ID: `1E06000000000003`, Task: `1E06000000000A03`, Reward: `1E06000000000B03`
- Item: `immersiveengineering:bottled_apple_juice_2`
- dependencies: ["1E06000000000002"]
- x: -1.5, y: 20.0

Quest 4 - Juice Pouring:
- ID: `1E06000000000004`, Task: `1E06000000000A04`, Reward: `1E06000000000B04`
- Item: `immersiveengineering:apple_juice_bucket`
- Icon: `minecraft:bucket`
- dependencies: ["1E06000000000001"]
- x: -3.0, y: 18.5

---

## Task 8: Write Chapter SNBT — Branch C (Casino)

**Files:**
- Modify: `runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt`

**Add 6 quests (IDs 1E07000000000001–1E07000000000006).**

Layout — branch down-right from Metal Press area:

| Quest | x | y |
|-------|---|---|
| Blackjack Table | 9.0 | 14.0 |
| Blank Mold | 10.5 | 14.0 |
| Coin Dies | 10.5 | 15.5 |
| Anneal Blanks | 10.5 | 17.0 |
| Mint Coins | 10.5 | 18.5 |
| Slot Machine | 10.5 | 20.0 |

Quest 1 - Blackjack Table:
- ID: `1E07000000000001`, Task: `1E07000000000A01`, Reward: `1E07000000000B01`
- Item: `immersive_gambling:blackjack_table`
- dependencies: ["1E03000000000002"] (Metal Press)
- x: 9.0, y: 14.0

Quest 2 - Blank Mold:
- ID: `1E07000000000002`, Task: `1E07000000000A02`, Reward: `1E07000000000B02`
- Item: `immersive_gambling:blank_mold`
- dependencies: ["1E03000000000002"] (Metal Press)
- x: 10.5, y: 14.0

Quest 3 - Coin Dies:
- ID: `1E07000000000003`, Task: `1E07000000000A03`, Reward: `1E07000000000B03`
- Item: `immersive_gambling:copper_coin_die`
- dependencies: ["1E07000000000002"]
- x: 10.5, y: 15.5

Quest 4 - Anneal Blanks:
- ID: `1E07000000000004`, Task: `1E07000000000A04`, Reward: `1E07000000000B04`
- Item: `immersive_gambling:annealed_copper_blank`
- dependencies: ["1E07000000000003"]
- x: 10.5, y: 17.0

Quest 5 - Mint Coins:
- ID: `1E07000000000005`, Task: `1E07000000000A05`, Reward: `1E07000000000B05`
- Item: `immersive_gambling:copper_coin`
- dependencies: ["1E07000000000004"]
- x: 10.5, y: 18.5

Quest 6 - Slot Machine:
- ID: `1E07000000000006`, Task: `1E07000000000A06`, Reward: `1E07000000000B06`
- Item: `immersive_gambling:slot_machine`
- dependencies: ["1E07000000000005"]
- x: 10.5, y: 20.0

---

## Task 9: Write Chapter SNBT — Section 5 (Advanced)

**Files:**
- Modify: `runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt`

**Add 5 quests (IDs 1E08000000000001–1E08000000000005) and close the quests array.**

Layout — scattered around the Metal Press area:

| Quest | x | y |
|-------|---|---|
| Mining Drill | 4.5 | 17.0 |
| Buzzsaw | 4.5 | 18.5 |
| Skyhook | 6.0 | 17.0 |
| Capacitor Backpack | 6.0 | 18.5 |
| Improved Blast Furnace | 4.5 | 6.5 |

Quest 1 - Mining Drill:
- ID: `1E08000000000001`, Task: `1E08000000000A01`, Reward: `1E08000000000B01`
- Item: `immersiveengineering:drill`
- dependencies: ["1E03000000000002"] (Metal Press)
- x: 4.5, y: 17.0

Quest 2 - Buzzsaw:
- ID: `1E08000000000002`, Task: `1E08000000000A02`, Reward: `1E08000000000B02`
- Item: `immersiveengineering:buzzsaw`
- dependencies: ["1E03000000000002"] (Metal Press)
- x: 4.5, y: 18.5

Quest 3 - Skyhook:
- ID: `1E08000000000003`, Task: `1E08000000000A03`, Reward: `1E08000000000B03`
- Item: `immersiveengineering:skyhook`
- dependencies: ["1E03000000000002"] (Metal Press)
- x: 6.0, y: 17.0

Quest 4 - Capacitor Backpack:
- ID: `1E08000000000004`, Task: `1E08000000000A04`, Reward: `1E08000000000B04`
- Item: `immersiveengineering:powerpack`
- dependencies: ["1E02000000000005"] (LV Accumulator)
- x: 6.0, y: 18.5

Quest 5 - Improved Blast Furnace:
- ID: `1E08000000000005`, Task: `1E08000000000A05`, Reward: `1E08000000000B05`
- Item: `immersiveengineering:advanced_blast_furnace`
- dependencies: ["1E01000000000008"] (Blast Furnace)
- x: 4.5, y: 4.5

Close the file:
```snbt
	]
}
```

**Step 2: Validate complete chapter**

```bash
python ~/.claude/skills/ftb-quests/scripts/validate_chapter.py \
  runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt
```

Expected: 47 quests, 47 tasks, 47 rewards, no errors.

---

## Task 10: Write Lang Entries

**Files:**
- Modify: `runs/client/config/ftbquests/quests/lang/en_us.snbt`

**Step 1: Remove all OLD Immersive Engineering lang entries**

First extract old quest IDs from backup, then remove those entries from lang file. The old entries use IDs like `2E9D1131DC21CC5B`, `04DD3F761C210822`, etc. (random hex from ATM-10 port).

Be careful — the lang file is shared across ALL chapters. Only remove entries matching old IE quest IDs.

**Step 2: Add new lang entries**

APPEND all 47 quest lang entries to the file. Chapter title entry stays the same (`chapter.22C20C1827FE6805.title: "Immersive Engineering"`).

Full lang entries for all 47 quests — format:
```snbt
	quest.1E01000000000001.title: "Engineer's Hammer"
	quest.1E01000000000001.quest_desc: ["The primary tool for Immersive Engineering. Craft it to form multiblock structures and rotate blocks."]
```

**Complete lang entry list:**

### Section 1: Foundations
```
quest.1E01000000000001.title: "Engineer's Hammer"
quest.1E01000000000001.quest_desc: ["The primary tool for Immersive Engineering. Craft it to form multiblock structures and rotate blocks."]

quest.1E01000000000002.title: "Coke Oven"
quest.1E01000000000002.quest_desc: ["A multiblock kiln that converts coal into coal coke and creosote oil. Build with sandstone bricks in a 3x3x3 hollow cube."]

quest.1E01000000000003.title: "Coal Coke"
quest.1E01000000000003.quest_desc: ["Burns twice as long as coal and is required for steel production. Creosote oil is a useful byproduct for treated wood."]

quest.1E01000000000004.title: "Alloy Kiln"
quest.1E01000000000004.quest_desc: ["Smelts two materials into alloys without power. Build with kiln bricks in a 2x2x2 cube."]

quest.1E01000000000005.title: "Constantan Ingot"
quest.1E01000000000005.quest_desc: ["An alloy of copper and nickel, smelted in the Alloy Kiln. Constantan is used in IE's thermoelectric generators and heating coils, making it essential for power infrastructure."]

quest.1E01000000000006.title: "Electrum Ingot"
quest.1E01000000000006.quest_desc: ["Gold and silver combined in the Alloy Kiln. Electrum is the primary conductor material for IE wiring and electrical components."]

quest.1E01000000000007.title: "Brass Ingot"
quest.1E01000000000007.quest_desc: ["Copper and zinc smelted together. Brass appears in various IE mechanical components and is shared with Create's crafting system."]

quest.1E01000000000008.title: "Blast Furnace"
quest.1E01000000000008.quest_desc: ["Smelts iron into steel using coal coke. The crude version is a 3x3x3 multiblock; the improved version adds hoppers for automation."]

quest.1E01000000000009.title: "Steel Ingot"
quest.1E01000000000009.quest_desc: ["Steel is the backbone of IE. Most machines, tools, and structures require it."]
```

### Section 2: Power & Wiring
```
quest.1E02000000000001.title: "Treated Wood"
quest.1E02000000000001.quest_desc: ["Soak wood planks in creosote oil to produce treated wood. This weatherproofed lumber is the foundation of IE's electrical infrastructure — used in poles, connectors, and most machine housings."]

quest.1E02000000000002.title: "Engineer's Workbench"
quest.1E02000000000002.quest_desc: ["The crafting station for wires, components, and blueprints. Place a treated wood fence and slab together to form the multiblock. Most IE recipes beyond basic smelting require this station."]

quest.1E02000000000003.title: "Wire Connectors"
quest.1E02000000000003.quest_desc: ["Connectors attach to blocks and transfer Forge Energy through wires. Start with LV connectors and copper wire. Higher voltage tiers (MV, HV) carry more power but require better insulation and materials."]

quest.1E02000000000004.title: "Thermoelectric Generator"
quest.1E02000000000004.quest_desc: ["Generates power from temperature differentials between adjacent blocks. Place hot blocks (lava, magma) on one side and cold blocks (ice, packed ice) on the other. A reliable early-game power source."]

quest.1E02000000000005.title: "LV Accumulator"
quest.1E02000000000005.quest_desc: ["Stores Forge Energy for machines and tools. Connect it to a generator with LV wire and connectors to build your first power grid. Without stored power, most IE machines won't operate."]
```

### Section 3: Core Machines
```
quest.1E03000000000001.title: "Crusher"
quest.1E03000000000001.quest_desc: ["A multiblock that grinds ores into dusts, doubling your yield per ore. Build it with steel scaffolding, fencing, and hoppers. Feed it power and ores — it handles the rest. The Crusher is one of IE's most-used early machines."]

quest.1E03000000000002.title: "Metal Press"
quest.1E03000000000002.quest_desc: ["Stamps ingots into plates, rods, wires, and gears using interchangeable molds. Nearly every advanced IE recipe requires pressed components. This machine also drives the gun blueprint and coin minting systems."]

quest.1E03000000000003.title: "Squeezer"
quest.1E03000000000003.quest_desc: ["Extracts fluids and byproducts from solid inputs. Crush seeds for plant oil, or process fruits into juices with unique potion-like effects. A key machine for both biodiesel production and the Juicery branch."]

quest.1E03000000000004.title: "Fermenter"
quest.1E03000000000004.quest_desc: ["Converts plant matter into ethanol. Combined with plant oil from the Squeezer, ethanol is the base ingredient for biodiesel — IE's most efficient liquid fuel."]

quest.1E03000000000005.title: "Refinery"
quest.1E03000000000005.quest_desc: ["Blends ethanol and plant oil into biodiesel. This high-energy fuel powers the Diesel Generator, IE's best power source. Building a Refinery means you've mastered IE's fluid processing chain."]

quest.1E03000000000006.title: "Diesel Generator"
quest.1E03000000000006.quest_desc: ["The most powerful IE generator. Burns biodiesel to produce substantial Forge Energy. Connect it to MV or HV accumulators to power your entire factory."]

quest.1E03000000000007.title: "Arc Furnace"
quest.1E03000000000007.quest_desc: ["An industrial-scale smelter that processes ores, alloys, and recycling in bulk. Requires significant power but replaces multiple furnaces and kilns. Accepts additives for advanced alloy recipes."]

quest.1E03000000000008.title: "Excavator"
quest.1E03000000000008.quest_desc: ["A massive multiblock mining machine that extracts ore veins from underground deposits. Use the Core Sample Drill first to locate veins, then build the Excavator above them for automated resource extraction."]
```

### Section 4: Logistics
```
quest.1E04000000000001.title: "Conveyor Belts"
quest.1E04000000000001.quest_desc: ["Move items automatically between machines, hoppers, and chests. Place them on any surface and they'll push items in the direction they face. Vertical, dropping, and splitting variants let you build complex sorting lines."]

quest.1E04000000000002.title: "Fluid Pipes"
quest.1E04000000000002.quest_desc: ["Transfer fluids between tanks, machines, and the Refinery chain. IE pipes auto-connect and support pump-assisted flow for longer distances. Essential for any biodiesel or juice production setup."]

quest.1E04000000000003.title: "Silo"
quest.1E04000000000003.quest_desc: ["A large multiblock that stores up to 41,472 items of a single type. Build it from sheet metal in a 3x3 footprint, 5 blocks tall. Attach conveyors or hoppers to automate input and output."]

quest.1E04000000000004.title: "Tank"
quest.1E04000000000004.quest_desc: ["Stores up to 512 buckets of any fluid. Same construction style as the Silo — sheet metal walls with a 3x3 footprint. Connect fluid pipes to manage your creosote, biodiesel, or juice reserves."]

quest.1E04000000000005.title: "Item Router"
quest.1E04000000000005.quest_desc: ["Filters and distributes items across multiple outputs based on configurable rules. Useful for sorting ore processing outputs or directing pressed components to the right storage."]
```

### Branch A: Armory
```
quest.1E05000000000001.title: "Blueprint: Firearms"
quest.1E05000000000001.quest_desc: ["Acquire the Firearms blueprint from the Engineer's Workbench. IE's blueprint system replaces the standard gun crafting — all Point Blank weapons are manufactured using IE materials and the Metal Press."]

quest.1E05000000000002.title: "Craft a Pistol"
quest.1E05000000000002.quest_desc: ["Your first firearm. Pistols require steel components, treated wood grips, and pressed metal parts. Compact and reliable — a good sidearm while you work toward heavier hardware."]

quest.1E05000000000003.title: "Pistol Ammunition"
quest.1E05000000000003.quest_desc: ["Ammunition is consumed on use and must be manufactured in bulk. Set up a pressing line for casings and projectiles to keep your sidearm loaded. The same manufacturing principles apply to all weapon calibers."]

quest.1E05000000000004.title: "Craft a Rifle"
quest.1E05000000000004.quest_desc: ["Rifles demand more materials than pistols — steel barrels, mechanical components, and electronic parts for optics compatibility. Higher damage and range make them worth the investment."]

quest.1E05000000000005.title: "Craft a Shotgun"
quest.1E05000000000005.quest_desc: ["Shotguns use wider steel barrels and reinforced stocks. Devastating at close range with spread patterns that clear groups of mobs efficiently."]

quest.1E05000000000006.title: "Heavy Ordnance"
quest.1E05000000000006.quest_desc: ["Machine guns and launchers sit at the top of the arms tree. They consume significant IE resources — steel plates, electronic components, and osmium ingots — but deliver unmatched firepower."]

quest.1E05000000000007.title: "Blueprint: Scopes"
quest.1E05000000000007.quest_desc: ["Scopes and optics are crafted from glass panes, electronic components, and osmium. Each scope type offers different zoom levels and reticle styles for various combat ranges."]

quest.1E05000000000008.title: "Blueprint: Attachments"
quest.1E05000000000008.quest_desc: ["Suppressors, grips, and muzzle devices modify weapon handling. Suppressors reduce noise, grips improve stability, and muzzle brakes control recoil. All crafted from steel and aluminum on the workbench."]
```

### Branch B: Juicery
```
quest.1E06000000000001.title: "Squeeze a Fruit"
quest.1E06000000000001.quest_desc: ["Feed any fruit into the Squeezer to extract its juice. Each fruit produces a unique juice with distinct potion-like effects — apple juice grants bonus health and luck, while melon juice reduces gravity. Check JEI for the full list of supported fruits."]

quest.1E06000000000002.title: "Bottled Juice"
quest.1E06000000000002.quest_desc: ["Fill glass bottles from juice fluid to create drinkable potions. Each juice provides attribute modifiers and status effects when consumed. Bottled juice stacks and is easy to carry into combat or exploration."]

quest.1E06000000000003.title: "Potency Levels"
quest.1E06000000000003.quest_desc: ["Juices come in three potency tiers. Potency I is standard strength, II provides 1.5x effects, and III delivers double potency. Higher tiers require additional processing or concentrated fruit inputs."]

quest.1E06000000000004.title: "Juice Pouring"
quest.1E06000000000004.quest_desc: ["Pour juice from a bucket to create a fluid block in the world. Any entity that walks through or falls into the liquid receives its effects. Use this to create buff zones for allies or add environmental effects to your base."]
```

### Branch C: Casino
```
quest.1E07000000000001.title: "Blackjack Table"
quest.1E07000000000001.quest_desc: ["A multiplayer card game supporting up to four players. Place any item stack as your bet — if you win, the table doubles it. This makes blackjack a powerful item duplicator for rare tools, filled backpacks, or valuable materials. Hit or stand against the dealer, and blackjack pays 1.5x. Built from wool, planks, and gold."]

quest.1E07000000000002.title: "Blank Mold"
quest.1E07000000000002.quest_desc: ["Craft a blank mold at the Engineer's Workbench using steel plates and a wirecutter. This mold is the starting point for the coin minting pipeline — it's used to stamp out coin dies for each metal type."]

quest.1E07000000000003.title: "Coin Dies"
quest.1E07000000000003.quest_desc: ["Produce coin dies from the blank mold at the workbench. Each die — copper, nickel, and silver — has 1,000 uses before it wears out. You'll need one die per coin denomination."]

quest.1E07000000000004.title: "Anneal Blanks"
quest.1E07000000000004.quest_desc: ["Heat-treat raw coin blanks in the Alloy Smelter with coke dust. Annealing hardens the metal and prepares it for the press. The process takes 100 ticks per blank — batch production is recommended."]

quest.1E07000000000005.title: "Mint Coins"
quest.1E07000000000005.quest_desc: ["Stamp annealed blanks in the Metal Press using your coin dies. Copper coins are the base currency, nickel coins are worth 2x, and silver coins 3x. Higher denominations multiply your gambling payouts."]

quest.1E07000000000006.title: "Slot Machine"
quest.1E07000000000006.quest_desc: ["A placeable gambling machine with four win tiers — from small payouts to a full jackpot with particle effects and rare loot. Insert coins, pull the lever, and test your luck. Crafted from iron blocks, gold, redstone, and an electronic component."]
```

### Section 5: Advanced
```
quest.1E08000000000001.title: "Mining Drill"
quest.1E08000000000001.quest_desc: ["A powered handheld mining tool that chews through stone and ore faster than diamond picks. Requires a drill head and power from an IE capacitor backpack or external charger. Auger heads can be upgraded for wider mining patterns."]

quest.1E08000000000002.title: "Buzzsaw"
quest.1E08000000000002.quest_desc: ["A powered saw that fells entire trees in one cut. Like the drill, it runs on stored Forge Energy and accepts interchangeable blade attachments for different wood types and cutting speeds."]

quest.1E08000000000003.title: "Skyhook"
quest.1E08000000000003.quest_desc: ["Clips onto overhead IE wires and rides them like a zipline. Connect wire networks across your base or build long-range transport lines between locations. A fast, satisfying way to travel without elytra."]

quest.1E08000000000004.title: "Capacitor Backpack"
quest.1E08000000000004.quest_desc: ["A wearable battery that powers your drill, buzzsaw, and other IE tools on the go. Charges from any IE power source and eliminates the need to return to base for tool recharging."]

quest.1E08000000000005.title: "Improved Blast Furnace"
quest.1E08000000000005.quest_desc: ["The upgraded blast furnace adds hopper inputs and outputs for fully automated steel production. Feed it iron and coal coke from conveyors and collect steel ingots without manual interaction. A meaningful upgrade once your factory is running."]
```

**Step 3: Verify lang coverage**

```bash
python ~/.claude/skills/ftb-quests/scripts/verify_lang.py \
  runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt \
  runs/client/config/ftbquests/quests/lang/en_us.snbt
```

Expected: All 47 quests have title + description entries.

---

## Task 11: Validate Complete Chapter

**Step 1: Run validation script**

```bash
python ~/.claude/skills/ftb-quests/scripts/validate_chapter.py \
  runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt
```

Expected: 47 quests, 47 tasks, 47 rewards, 0 errors, prefix `1E`.

**Step 2: Run lang verification**

```bash
python ~/.claude/skills/ftb-quests/scripts/verify_lang.py \
  runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt \
  runs/client/config/ftbquests/quests/lang/en_us.snbt
```

**Step 3: Verify no orphaned old lang entries**

Check that old ATM-10 quest IDs (from the backup) no longer have lang entries cluttering the file.

---

## Task 12: Commit Draft State

**Step 1: Commit pre-load draft**

```bash
git add docs/plans/2026-02-06-immersive-engineering-chapter-design.md
git add docs/plans/2026-02-06-immersive-engineering-implementation.md
git add docs/ftbquests_setup_guide.md
git commit -m "docs: IE chapter rewrite design and implementation plan"
```

Note: Do NOT commit the runs/client files (they're not git-tracked). Do NOT commit defaultconfigs/ changes yet.

---

## Task 13: Post-First-Load Recovery (MANUAL + ASSISTED)

**This task requires running the game client.** The user must:

1. Run `./gradlew runClient`
2. Open a world and access the quest book
3. Navigate to the IE chapter to trigger ID loading
4. Exit the game

**After the user exits:**

**Step 1: Extract regenerated IDs**

```bash
python ~/.claude/skills/ftb-quests/scripts/extract_ids.py \
  runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt \
  --generate-lang
```

**Step 2: Create ID mapping**

Map old structured IDs → new regenerated IDs by matching quest positions (x,y coordinates persist through regeneration).

**Step 3: Update lang entries**

APPEND new lang entries using regenerated IDs. Do NOT delete the structured-ID entries yet (they'll be orphaned but harmless).

**Step 4: Restore dependencies**

FTB Quests strips dependencies on first load. Re-insert all dependency arrays using the new regenerated IDs and the dependency map from the design.

**Step 5: Verify**

```bash
python ~/.claude/skills/ftb-quests/scripts/validate_chapter.py \
  runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt
python ~/.claude/skills/ftb-quests/scripts/verify_lang.py \
  runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt \
  runs/client/config/ftbquests/quests/lang/en_us.snbt
```

---

## Task 14: In-Game Testing (MANUAL)

User must verify in-game:

1. Chapter title shows "Immersive Engineering"
2. All 47 quest titles display correctly
3. All descriptions are readable (no broken formatting)
4. Dependency lines show correctly between connected quests
5. Hard gates work: locked sections don't unlock prematurely
6. All item detection tasks trigger on correct items
7. Layout is clean — no overlapping quests

---

## Task 15: Finalize — Copy to Distribution

**Step 1: Copy to defaultconfigs**

```bash
cp runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt \
   defaultconfigs/ftbquests/quests/chapters/immersive_engineering.snbt
cp runs/client/config/ftbquests/quests/lang/en_us.snbt \
   defaultconfigs/ftbquests/quests/lang/en_us.snbt
```

**Step 2: Sync to config (git mirror)**

```bash
cp defaultconfigs/ftbquests/quests/chapters/immersive_engineering.snbt \
   config/ftbquests/quests/chapters/immersive_engineering.snbt
cp defaultconfigs/ftbquests/quests/lang/en_us.snbt \
   config/ftbquests/quests/lang/en_us.snbt
```

**Step 3: Remove backup**

```bash
rm runs/client/config/ftbquests/quests/chapters/immersive_engineering.snbt.backup
```

**Step 4: Commit final state**

```bash
git add defaultconfigs/ftbquests/quests/chapters/immersive_engineering.snbt
git add defaultconfigs/ftbquests/quests/lang/en_us.snbt
git add config/ftbquests/quests/chapters/immersive_engineering.snbt
git add config/ftbquests/quests/lang/en_us.snbt
git commit -m "feat: rewrite Immersive Engineering quest chapter (126→47 quests)

Hub-and-spoke structure with linear core progression plus three
goal-oriented branches: Armory (guns), Juicery (fruit juice),
and Casino (gambling). Hard gates at Steel, LV Accumulator,
Metal Press, and Squeezer."
```
